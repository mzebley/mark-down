# mark↓ Angular Adapter
*(published as `@mzebley/mark-down-angular`)*

Angular bindings for the [mark↓ core runtime](../core/README.md). This package wraps `SnippetClient` with Angular-friendly providers, services, and components so you can render Markdown snippets safely inside your application. For background on the monorepo, see the [root README](../../README.md).

## Table of contents

1. [Installation](#installation)
2. [Bootstrap configuration](#bootstrap-configuration)
3. [Consuming snippets](#consuming-snippets)
4. [`<snippet-view>` component](#snippet-view-component)
5. [Server-side rendering](#server-side-rendering)
6. [Testing tips](#testing-tips)
7. [Roadmap](#roadmap)
8. [Related packages](#related-packages)

## Installation

Install the Angular adapter alongside the core runtime:

```bash
npm install @mzebley/mark-down-angular @mzebley/mark-down
```

You will also need a manifest generated by the [CLI](../cli/README.md).

## Bootstrap configuration

Provide a shared `SnippetClient` from your root bootstrap call or feature module:

```ts
import { bootstrapApplication } from '@angular/platform-browser';
import { provideMarkDown } from '@mzebley/mark-down-angular';

bootstrapApplication(AppComponent, {
  providers: [
    ...provideMarkDown({
      manifest: '/snippets-index.json',
    }),
  ],
});
```

`provideMarkDown` wires up the client as an Angular provider using the options you pass through. The manifest can be a URL, a factory, or a pre-fetched array—identical to the [core runtime options](../core/README.md#client-options).

## Consuming snippets

Inject `SnippetService` into components or services to access Observables for snippets:

```ts
import { Component, inject } from '@angular/core';
import { SnippetService } from '@mzebley/mark-down-angular';

@Component({
  selector: 'docs-hero',
  template: `
    <ng-container *ngIf="hero$ | async as hero">
      <h1>{{ hero.title }}</h1>
      <div [innerHTML]="hero.html"></div>
    </ng-container>
  `,
})
export class DocsHeroComponent {
  private readonly snippets = inject(SnippetService);
  readonly hero$ = this.snippets.get('getting-started-welcome');
}
```

The service mirrors the core client APIs (`get`, `list`, `listByType`, `listByGroup`) but returns cold Observables that share cached results across subscribers.

## `<snippet-view>` component

Render snippets declaratively with the bundled standalone component:

```html
<snippet-view [slug]="'components-button'" (loaded)="onSnippetLoaded($event)"></snippet-view>
```

Features:

- Uses Angular's `DomSanitizer` to render HTML safely.
- Emits a `loaded` event once the snippet resolves so parent components can react.
- Provides built-in "Loading snippet…" and "Snippet not found" fallbacks (customize by wrapping the component or using the service directly).
- Supports `class`/`ngClass` bindings for styling since it renders a standard `<div>`.

## Server-side rendering

When running in Angular Universal, supply a server-compatible fetch implementation:

```ts
import fetch from 'node-fetch';

provideMarkDown({
  manifest: () => import('../snippets-index.json'),
  fetcher: (input, init) => fetch(input as string, init),
});
```

The provider forwards all options to the underlying `SnippetClient`, so SSR and preloaded manifests work exactly like the core package.

## Testing tips

- Provide a mock manifest array during tests: `provideMarkDown({ manifest: mockManifest })`.
- Use `SnippetService` with the Angular `TestBed` to assert filtering behaviour.
- Pair with the [example application](../../examples/basic/README.md) to see how snippets integrate with routing and feature modules.

## Roadmap

- **Template primitives** – structural directives for rendering snippet lists via `*markDownSnippets`.
- **AsyncPipe optimisations** – helpers that automatically unsubscribe / reuse cached Observables when using standalone components.
- **Schematics** – Angular CLI generator for wiring `provideMarkDown` + `SnippetViewComponent`.
- **SSR hydration helpers** – share manifest snapshots between server and browser to avoid double fetching.

## Related packages

- [Core runtime](../core/README.md)
- [CLI](../cli/README.md)
- [React adapter](../react/README.md)
- [Project overview](../../README.md)
